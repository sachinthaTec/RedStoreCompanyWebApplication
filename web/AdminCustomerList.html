<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Admin - Customer List- REDStore</title>
        <link rel="icon" type="image/png" href="assets/IMG/Rs-logo.svg.png">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
        <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    </head>
    <style>
        .admin-header {
            background: linear-gradient(90deg, #1e1e1e 60%, #dd2476 100%);
            color: white;
            padding: 20px;
            text-align: center;
            border-bottom-left-radius: 20px;
            border-bottom-right-radius: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }
        .logo img {
            height: 40px;
        }
        
        @media print {
    body * {
      visibility: hidden;
    }

    #print-section, #print-section * {
      visibility: visible;
    }

    #print-section {
      position: absolute;
      left: 0;
      top: 0;
      width: 100%;
    }
  }
    </style>
    <div class="admin-header">
        <a class="navbar-brand logo" href="Dashboard.html">
            <img src="assets/IMG/Rs-logo.svg.png" alt="RED Store">
        </a>
        <h2>Admin - Customer Lis</h2>
    </div>
    <body class="bg-light">
        <div class="container mt-5">
            <h2 class="mb-4 text-center">Customer List</h2>


            <div class="table-responsive">
                <div class="d-flex justify-content-end mb-3">
                    <button class="btn btn-primary" onclick="window.print()">
                        üñ®Ô∏è Print Report
                    </button>
                </div>

                <div id="print-section">
                    <table class="table table-bordered table-hover shadow-sm bg-white">
                        <thead class="table-dark">
                            <tr>
                                <th>ID</th>
                                <th>First Name</th>
                                <th>Last Name</th>
                                <th>Email</th>
                                <th>Mobile</th>
                                <th>Registered Date</th>
                            </tr>
                        </thead>
                        <tbody id="customer-tbody">
                            <!-- loaded by JS -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <script>
            async function loadCustomers() {
                try {
                    const res = await axios.get("LoadAllCustomers");
                    if (res.data.status) {
                        const tbody = document.getElementById("customer-tbody");
                        tbody.innerHTML = "";

                        res.data.userList.forEach(user => {
                            const tr = document.createElement("tr");

                            tr.innerHTML = `
                                <td>${user.id}</td>
                                <td>${user.first_name}</td>
                                <td>${user.last_name}</td>
                                <td>${user.email}</td>
                                <td>${user.mobile}</td>
                                <td>${new Date(user.created_at).toLocaleDateString()}</td>
                            `;
                            tbody.appendChild(tr);
                        });
                    } else {
                        alert("Failed to load customers: " + res.data.message);
                    }
                } catch (err) {
                    console.error(err);
                    alert("Error fetching customer data");
                }
            }

            window.onload = loadCustomers;
        </script>
    </body>
</html>
